<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="pos_z_thermal_report_template">
            <receipt align='center' width='40' value-thousands-separator='' >
                <t t-foreach="docs" t-as="o">
                	<t t-if="o and 'company_id' in o">
						<t t-set="company" t-value="o.company_id.sudo()" />
					</t>
					<t t-if="not o or not 'company_id' in o">
						<t t-set="company" t-value="res_company" />
					</t>
					<div class="text-center">
						<img t-if="company.logo_web"
							t-att-src="'data:image/png;base64,%s' % to_text(company.logo_web)"
							style="height: 80px;" />
					</div>
                    <div size='double-height' style="font-size:20px;" align="center">
                        <b>RESUMEN DE SESION</b>
                    </div>
                    <div align="left">
                    	<b>Usuario: </b>
						<span t-field="o.user_id" />
						<br />
						<b>Fecha de apertura: </b>
						<span t-field="o.start_at" />
						<br />
						<b>Fecha de cierre: </b>
						<span t-field="o.stop_at" />
						<br />
						<b>Numero de Tickets: </b>
						<span t-field="o.tickets_num" />
						<br />
						<b>Desde: </b>
						<span t-field="o.ticket_first_id.display_name" />
						<br />
						<b>Hasta: </b>
						<span t-field="o.ticket_last_id.display_name" />
						<br />
                    </div>
					<hr></hr>
					<div align="center">
                        <b>Resumen por Métodos de pago</b>
                    </div>
					<t t-foreach="o.statement_ids" t-as="i">
						<line>
							<left>
								<b><span t-field="i.journal_id" /></b> (<span t-field="i.payment_count" />)
							</left>
							<right align="right">
								<!-- si es el diario de efectivo, mostrar solo las ventas, no saldo inicial ni ingresos/egreos
									pero otros diarios si mostrar ingresos y egresos, para que no haya descuadre -->
								<t t-if="i == o.cash_register_id">
									<span t-field="i.total_entry_encoding_custom" />
								</t>
								<t t-if="i != o.cash_register_id">
									<span t-field="i.total_entry_encoding" />
								</t>
							</right>
						</line>
					</t>
					<hr></hr>
					<line>
						<left>
							<b>Pagos totales recibidos:</b>
						</left>
						<right align="right">
							<span t-field="o.statements_total" />
						</right>
					</line>
					<line>
						<left>
							<b>Otros Medios:</b>
						</left>
						<right align="right">
							<span t-field="o.statements_bank_total" />
						</right>
					</line>
					<t t-if="abs(o.statements_cn_total) > 0">
						<hr></hr>
						<br />
						<div align="center">
	                        <b>Notas de Crédito</b>
	                    </div>
	                    <t t-foreach="o.statement_ids" t-as="i">
	                    	<t t-if="abs(i.total_entry_encoding_cn)>0">
								<line>
									<left>
										<b><span t-field="i.journal_id" /></b>
									</left>
									<right align="right">
										<span t-field="i.total_entry_encoding_cn" />
									</right>
								</line>
							</t>
						</t>
						<line>
							<left>
								<b>Total NC:</b>
							</left>
							<right align="right">
								<span t-field="o.statements_cn_total" />
							</right>
						</line>
					</t>
					<hr></hr>
					<br />
					<div align="center">
                        <b>Control Efectivo</b>
                    </div>
                    <line>
						<left><b>Saldo de apertura:</b></left>
						<right align="right"><span t-field="o.cash_register_balance_start" /></right>
					</line>
					<line>
						<left><b>+ ventas</b></left>
						<right align="right"><span t-field="o.cash_register_total_entry_encoding_custom" /></right>
					</line>
					<line>
						<left><b>+ Ingreso Efectivo</b></left>
						<right align="right"><span t-field="o.cash_register_total_entry_encoding_put_in" /></right>
					</line>
					<line>
						<left><b>- Egreso Efectivo</b></left>
						<right align="right"><span t-field="o.cash_register_total_entry_encoding_take_out" /></right>
					</line>
					<line>
						<left><b>- Depositos</b></left>
						<right align="right"><span t-field="o.cash_register_total_entry_encoding_deposit" /></right>
					</line>
					<line>
						<left><b>- Notas de Credito</b></left>
						<right align="right"><span t-field="o.statements_cn_total" /></right>
					</line>
					<line>
						<left><b>(+/-) Ajustes de cierre</b></left>
						<right align="right"><span t-field="o.cash_register_total_entry_encoding_adjustment" /></right>
					</line>
					<hr></hr>
					<line>
						<left><b>Saldo de cierre:</b></left>
						<right align="right"><span t-field="o.cash_register_balance_end_real" /></right>
					</line>
                </t>
            </receipt>
        </template>
    </data>
</odoo>
