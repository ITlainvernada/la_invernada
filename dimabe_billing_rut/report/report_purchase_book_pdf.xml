<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <data>
        <template id="report_purchase_book_pdf">
            <t t-call="web.html_container">
                <div class="page">
                    <div class="company_data">
                        <t t-set="company" t-value="env['res.company'].sudo().browse(company_get_id[0])" />
                        <span t-esc="company.name"/>
                        <span t-esc="company.invoice_rut" />
                        <span t-esc="company.get_address()"/> 
                    </div>
                    <center>
                        <h2>Reporte libro de compras</h2>
                    </center>
                    <span t-esc="from_date"></span>
                    <span t-esc="to_date"></span>
                    <span t-esc="company_get_id"></span>
                    <table border="1" style="width:100%;">
                        <center>
                            <h3>FACTURAS DE COMPRA ELECTRONICA</h3>
                        </center>
                        <!-- ***********  CAMPOS DE LA TABLA FACTURAS ELECTRONICAS *********** -->
                        <thead>
                            <tr>
                                <th>Cod.SII</th>
                                <th>Folio</th>
                                <th>Cor.Interno</th>
                                <th>Rut</th>
                                <th>Fecha</th>
                                <th>Nombre</th>
                                <th>#</th>
                                <th>Exento</th>
                                <th>Neto IVA</th>
                                <th>Total NETO</th>
                                <th>IVA</th>
                                <th>IVA no Recuperable</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <!-- *********** CUERPO DEL REPORTE FACTURAS ELECTRONICAS *********** -->
                        <tbody>
                            <t t-set="qty_invoice" t-value="0"/>
                            <t t-set="total_exento" t-value="0" />
                            <t t-set="total_neto_iva" t-value="0" />
                            <t t-set="total_iva" t-value="0" />
                            <t t-set="total_general" t-value="0" />
                            <tr t-foreach="get_invoices" t-as="invoice">
                                <t t-set="qty_invoice" t-value="qty_invoice + 1"/>
                                <t t-set="total_exento" t-value="total_exento + invoice.get_amount_exempt()" />
                                <t t-set="total_neto_iva" t-value="total_neto_iva + invoice.get_amount_neto()" />
                                <t t-set="total_iva" t-value="total_iva + invoice.amount_tax" />
                                <t t-set="total_general" t-value="total_general + invoice.amount_total" />
                                <!-- Codigo SII       -->
                                <td scope="row">
                                    <span t-field="invoice.dte_type_id.code"></span>
                                </td>
                                <!-- FOLIO       -->
                                <td scope="row">
                                    <span t-field="invoice.reference"></span>
                                </td>
                                <!-- Cor.Interno -->
                                <td scope="row">
                                    <span t-field="invoice.number"></span>
                                </td>
                                <!-- RUT         -->
                                <td scope="row">
                                    <span t-field="invoice.partner_id.invoice_rut"></span>
                                </td>
                                <!-- FECHA       -->
                                <td scope="row">
                                    <span t-field="invoice.date_invoice"></span>
                                </td>
                                <!-- NOMBRE      -->
                                <td scope="row">
                                    <span t-field="invoice.vendor_display_name"></span>
                                </td>
                                 <!-- cantidad factura      -->
                                 <td scope="row">
                                    
                                </td>
                                <!-- EXENTO      -->
                                <td scope="row">
                                    <span t-esc="invoice.format_amount(invoice.get_amount_exempt())"></span>
                                </td>
                                    
                                <!-- NETO IVA    -->
                                <td>
                                    <span t-esc="invoice.format_amount(invoice.get_amount_neto())"></span>
                                </td>
                                <!-- TOTAL NETO  -->
                                <td>
                                    <span t-field="invoice.amount_untaxed"></span>
                                </td>
                                <!-- IVA         -->
                                <td scope="row">
                                    <span t-field="invoice.amount_tax"></span>
                                </td>
                                <!-- IVA NO RECUP-->
                                <td scope="row">
                                    
                                </td>
                                <!-- TOTAL       -->
                                <td scope="row">
                                    <span t-field="invoice.amount_total"></span>
                                </td>
                            </tr>
                            <tr/>
                            <tr>
                                <td>TOTALES : </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>
                                    <span t-esc="qty_invoice"/>
                                </td>
                                <td>
                                    <span t-esc="invoice.format_amount(total_exento)" />
                                </td>
                                <td>
                                    <span t-esc="invoice.format_amount(total_neto_iva)" />
                                </td>
                                <td>
                                    <span t-esc="invoice.format_amount(total_exento + total_neto_iva)" />
                                </td>
                                <td>
                                    <span t-esc="invoice.format_amount(total_iva)" />
                                </td>
                                <td>
                                    $ 0
                                    <!-- TODO traer iva no recuperable-->
                                </td>
                                <td>
                                    <span t-esc="invoice.format_amount(total_general)" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="page">
                    <center>
                        <h2>Reporte libro de compras</h2>
                    </center>
                    <table border="1" style="width:100%;">
                        <center>
                            <h3>FACTURA COMPRA EXENTA ELECTRONICA</h3>
                        </center>
                        <!-- ***********  CAMPOS DE LA TABLA EXENTOS *********** -->
                        <thead class="thead-dark">
                            <tr>
                                <th>Cod.SII</th>
                                <th>Folio</th>
                                <th>Cor.Interno</th>
                                <th>Rut</th>
                                <th>Fecha</th>
                                <th>Nombre</th>
                                <th>#</th>
                                <th>Exento</th>
                                <th>Neto IVA</th>
                                <th>Total NETO</th>
                                <th>IVA</th>
                                <th>IVA no Recuperable</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <!-- *********** CUERPO DEL REPORTE EXENTOS *********** -->
                        <tbody>
                            <t t-set="qty_invoice" t-value="0"/>
                            <t t-set="total_exento" t-value="0" />
                            <t t-set="total_neto_iva" t-value="0" />
                            <t t-set="total_iva" t-value="0" />
                            <t t-set="total_general" t-value="0" />
                            <tr t-foreach="get_exempts" t-as="exempt">
                                <t t-set="qty_invoice" t-value="qty_invoice + 1"/>
                                <t t-set="total_exento" t-value="total_exento + exempt.get_amount_exempt()" />
                                <t t-set="total_neto_iva" t-value="total_neto_iva + exempt.get_amount_neto()" />
                                <t t-set="total_iva" t-value="total_iva + exempt.amount_tax" />
                                <t t-set="total_general" t-value="total_general + exempt.amount_total" />
                                <!-- Codigo SII       -->
                                <td scope="row">
                                    <span t-field="exempt.dte_type_id.code"></span>
                                </td>
                                <!-- FOLIO       -->
                                <td scope="row">
                                    <span t-field="exempt.reference">reference</span>
                                </td>
                                <!-- Cor.Interno -->
                                <td scope="row">
                                    <span t-field="exempt.number"></span>
                                </td>
                                <!-- RUT         -->
                                <td scope="row">
                                    <span t-field="exempt.partner_id.invoice_rut"></span>
                                </td>
                                <!-- FECHA       -->
                                <td scope="row">
                                    <span t-field="exempt.date_invoice"></span>
                                </td>
                                <!-- NOMBRE      -->
                                <td scope="row">
                                    <span t-field="exempt.vendor_display_name"></span>
                                </td>
                                <!-- cantidad factura      -->
                                <td scope="row">
                                    
                                </td>
                                <!-- EXENTO      -->
                                <td scope="row">
                                    <span t-esc="exempt.get_amount_exempt()"></span>
                                </td>
                                <!-- NETO IVA    -->
                                <td>
                                    <span t-esc="exempt.get_amount_neto()"></span>
                                </td>
                                <!-- TOTAL NETO  -->
                                <td>
                                    <span t-field="exempt.amount_untaxed"></span>
                                </td>
                                <!-- IVA         -->
                                <td scope="row">
                                    <span t-field="exempt.amount_tax"></span>
                                </td>
                                <!-- IVA NO RECUP-->
                                <td scope="row">
                                    
                                </td>
                                <!-- TOTAL       -->
                                <td scope="row">
                                    <span t-field="exempt.amount_total"></span>
                                </td>
                            </tr>
                            <tr/>
                            <tr>
                                <td>TOTALES : </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>
                                    <span t-esc="qty_invoice" />
                                </td>
                                <td>
                                    <span t-esc="exempt.format_amount(total_exento)" />
                                </td>
                                <td>
                                    <span t-esc="exempt.format_amount(total_neto_iva)" />
                                </td>
                                <td>
                                    <span t-esc="exempt.format_amount(total_exento + total_neto_iva)" />
                                </td>
                                <td>
                                    <span t-esc="exempt.format_amount(total_iva)" />
                                </td>
                                <td>
                                    $ 0
                                    <!-- TODO traer iva no recuperable-->
                                </td>
                                <td>
                                    <span t-esc="exempt.format_amount(total_general)" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>


                <div class="page">
                    <center>
                        <h2>Reporte libro de compras</h2>
                    </center>
                    <table border="1" style="width:100%;">
                        <center>
                            <h3>NOTA DE CREDITO COMPRA ELECTRONICA</h3>
                        </center>
                        <!-- ***********  CAMPOS DE LA TABLA CREDITO *********** -->
                        <thead class="thead-dark">
                            <tr>
                                <th>Cod.SII</th>
                                <th>Folio</th>
                                <th>Cor.Interno</th>
                                <th>Rut</th>
                                <th>Fecha</th>
                                <th>Nombre</th>
                                <th>#</th>
                                <th>Exento</th>
                                <th>Neto IVA</th>
                                <th>Total NETO</th>
                                <th>IVA</th>
                                <th>IVA no Recuperable</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <!-- *********** CUERPO DEL REPORTE CREDITO*********** -->
                        <tbody>
                            <t t-set="qty_invoice" t-value="0"/>
                            <t t-set="total_exento" t-value="0" />
                            <t t-set="total_neto_iva" t-value="0" />
                            <t t-set="total_iva" t-value="0" />
                            <t t-set="total_general" t-value="0" />
                            <tr t-foreach="get_credits" t-as="credit">
                                <t t-set="qty_invoice" t-value="qty_invoice + 1"/>
                                <t t-set="total_exento" t-value="total_exento + credit.get_amount_exempt()" />
                                <t t-set="total_neto_iva" t-value="total_neto_iva + credit.get_amount_neto()" />
                                <t t-set="total_iva" t-value="total_iva + credit.amount_tax" />
                                <t t-set="total_general" t-value="total_general + credit.amount_total" />
                                <!-- Codigo SII       -->
                                <td scope="row">
                                    <span t-field="credit.dte_type_id.code"></span>
                                </td>
                                <!-- FOLIO       -->
                                <td scope="row">
                                    <span t-field="credit.reference">reference</span>
                                </td>
                                <!-- Cor.Interno -->
                                <td scope="row">
                                    <span t-field="credit.number"></span>
                                </td>
                                <!-- RUT         -->
                                <td scope="row">
                                    <span t-field="credit.partner_id.invoice_rut"></span>
                                </td>
                                <!-- FECHA       -->
                                <td scope="row">
                                    <span t-field="credit.date_invoice"></span>
                                </td>
                                <!-- NOMBRE      -->
                                <td scope="row">
                                    <span t-field="credit.vendor_display_name"></span>
                                </td>
                                <!-- cantidad factura      -->
                                <td scope="row">
                                    
                                </td>
                                <!-- EXENTO      -->
                                <td scope="row">
                                    <span t-esc="credit.get_amount_exempt()"></span>
                                </td>
                                <!-- NETO IVA    -->
                                <td>
                                    <span t-esc="credit.get_amount_neto()"></span>
                                </td>
                                <!-- TOTAL NETO  -->
                                <td>
                                    <span t-field="credit.amount_untaxed"></span>
                                </td>
                                <!-- IVA         -->
                                <td scope="row">
                                    <span t-field="credit.amount_tax"></span>                                    
                                </td>
                                <!-- IVA NO RECUP-->
                                <td scope="row">
                                    
                                </td>
                                <!-- TOTAL       -->
                                <td scope="row">
                                    <span t-field="credit.amount_total"></span>
                                </td>
                            </tr>
                            <tr/>
                            <tr>
                                <td>TOTALES : </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>
                                    <span t-esc="qty_invoice" />
                                </td>
                                <td>
                                    <span t-esc="credit.format_amount(total_exento)" />
                                </td>
                                <td>
                                    <span t-esc="credit.format_amount(total_neto_iva)" />
                                </td>
                                <td>
                                    <span t-esc="credit.format_amount(total_exento + total_neto_iva)" />
                                </td>
                                <td>
                                    <span t-esc="credit.format_amount(total_iva)" />
                                </td>
                                <td>
                                    $ 0
                                    <!-- TODO traer iva no recuperable-->
                                </td>
                                <td>
                                    <span t-esc="credit.format_amount(total_general)" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>


                <div class="page">
                    <center>
                        <h2>Reporte libro de compras</h2>
                    </center>
                    <table border="1" style="width:100%;">
                        <center>
                            <h3>NOTA DE DEBITO COMPRA ELECTRONICA</h3>
                        </center>
                        <!-- ***********  CAMPOS DE LA TABLA DEBITO *********** -->
                        <thead class="thead-dark">
                            <tr>
                                <th>Cod.SII</th>
                                <th>Folio</th>
                                <th>Cor.Interno</th>
                                <th>Rut</th>
                                <th>Fecha</th>
                                <th>Nombre</th>
                                <th>#</th>
                                <th>Exento</th>
                                <th>Neto IVA</th>
                                <th>Total NETO</th>
                                <th>IVA</th>
                                <th>IVA no Recuperable</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <!-- *********** CUERPO DEL REPORTE DEBITO *********** -->
                        <tbody>
                            <t t-set="qty_invoice" t-value="0"/>
                            <t t-set="total_exento" t-value="0" />
                            <t t-set="total_neto_iva" t-value="0" />
                            <t t-set="total_iva" t-value="0" />
                            <t t-set="total_general" t-value="0" />
                            <tr t-foreach="get_debits" t-as="debit">
                                <t t-set="qty_invoice" t-value="qty_invoice + 1"/>
                                <t t-set="total_exento" t-value="total_exento + debit.get_amount_exempt()" />
                                <t t-set="total_neto_iva" t-value="total_neto_iva + debit.get_amount_neto()" />
                                <t t-set="total_iva" t-value="total_iva + debit.amount_tax" />
                                <t t-set="total_general" t-value="total_general + debit.amount_total" />
                                <!-- Codigo SII       -->
                                <td scope="row">
                                    <span t-field="debit.dte_type_id.code"></span>
                                </td>
                                <!-- FOLIO       -->
                                <td scope="row">
                                    <span t-field="debit.reference">reference</span>
                                </td>
                                <!-- Cor.Interno -->
                                <td scope="row">
                                    <span t-field="debit.number"></span>
                                </td>
                                <!-- RUT         -->
                                <td scope="row">
                                    <span t-field="debit.partner_id.invoice_rut"></span>
                                </td>
                                <!-- FECHA       -->
                                <td scope="row">
                                    <span t-field="debit.date_invoice"></span>
                                </td>
                                <!-- NOMBRE      -->
                                <td scope="row">
                                    <span t-field="debit.vendor_display_name"></span>
                                </td>
                                <!-- cantidad factura      -->
                                <td scope="row">
                                    
                                </td>
                                <!-- EXENTO      -->
                                <td scope="row">
                                    <span t-esc="debit.get_amount_exempt()"></span>
                                </td>
                                <!-- NETO IVA    -->
                                <td>
                                    <span t-esc="debit.get_amount_neto()"></span>
                                </td>
                                <!-- TOTAL NETO  -->
                                <td>
                                    <span t-field="debit.amount_untaxed"></span>
                                </td>
                                <!-- IVA         -->
                                <td scope="row">
                                    <span t-field="debit.amount_tax"></span>
                                </td>
                                <!-- IVA NO RECUP-->
                                <td scope="row">
                                    
                                </td>
                                <!-- TOTAL       -->
                                <td scope="row">
                                    <span t-field="debit.amount_total"></span>
                                </td>
                            </tr>
                            <tr/>
                            <tr>
                                <td>TOTALES : </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>
                                    <span t-esc="qty_invoice" />
                                </td>
                                <td>
                                    <span t-esc="debit.format_amount(total_exento)" />
                                </td>
                                <td>
                                    <span t-esc="debit.format_amount(total_neto_iva)" />
                                </td>
                                <td>
                                    <span t-esc="debit.format_amount(total_exento + total_neto_iva)" />
                                </td>
                                <td>
                                    <span t-esc="debit.format_amount(total_iva)" />
                                </td>
                                <td>
                                    $ 0
                                    <!-- TODO traer iva no recuperable-->
                                </td>
                                <td>
                                    <span t-esc="debit.format_amount(total_general)" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                    <!-- <t t-call="web.external_layout">
                        
                </t> -->
            </t>
        </template>
     </data>
</odoo>


 




    
    
